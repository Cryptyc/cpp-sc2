<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>SC2API: Tutorial 3: Building Marines and Scouting</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="SC2-Logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SC2API
   </div>
   <div id="projectbrief">An API for AI for StarCraft II</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Tutorial 3: Building Marines and Scouting </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>So far we've been focused on some of the simpler macro abilities required to make a bot. You've gotten your bot to build scv's and supply depots when it's running near the supply cap. In this tutorial we'll learn the following.</p>
<ol type="1">
<li>Building a Barracks.</li>
<li>Building Marines from said Barracks.</li>
<li>Scouting Your Opponent.</li>
</ol>
<p>This tutorial builds on the previous so make sure the code from the last tutorial is copy pasted into tutorial.cc and you can build/run it.</p>
<h2>Building a Barracks </h2>
<p>The first step to any good Terran build is to build marines, and to build marines we must first build a barracks. We've already seen how to construct supply depots so lets create some similar code for constructing a barracks. Modify your OnStep function to the following.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{C++}</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;virtual void OnStep() final {</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    TryBuildSupplyDepot();</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    TryBuildBarracks();</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;}</div></div><!-- fragment --><blockquote class="doxtable">
<p>We'll implement TryBuildBarracks shortly. </p>
</blockquote>
<p>First, we have some constraints we must satisfy to build a barracks, primarily, we need a supply depot. We'd also like to only build one for this this tutorial so lets create a helper function for counting unit types and we'll use that in TryBuildBarracks in order to determine if we should build one or not.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{C++}</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;size_t CountUnitType(UNIT_TYPEID unit_type) {</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    return Observation()-&gt;GetUnits(Unit::Alliance::Self, IsUnit(unit_type)).size();</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;}</div></div><!-- fragment --><p>That function is counting the number of a certain unit type the player owns. GetUnits takes a Filter parameter that allows you to remove units that don't meet a certain condition. In this case that condition is that the units are of the desired unit_type.</p>
<p>We now have the necessary helper functions to implement TryBuildBarracks.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{C++}</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;bool TryBuildBarracks() {</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    const ObservationInterface* observation = Observation();</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    if (CountUnitType(UNIT_TYPEID::TERRAN_SUPPLYDEPOT) &lt; 1) {</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;        return false;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;    }</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    if (CountUnitType(UNIT_TYPEID::TERRAN_BARRACKS) &gt; 0) {</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;        return false;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    }</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    return TryBuildStructure(ABILITY_ID::BUILD_BARRACKS);</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;}</div></div><!-- fragment --><p>You can build and run your code at this point, if you'd like, you should see your bot building a barracks after it completes its first supply depot. We'd now like that barracks to actually do something. Recall we've overwritten a OnUnitIdle event in an earlier tutorial, completion of the barracks should trigger that event!</p>
<h2>Building Marines </h2>
<p>Similar to how we construct SCVs we can now produce marines. Add the following code to the switch case in OnUnitIdle. The entire function should look like the following, the new code is the UNIT_TYPE::TERRAN_BARRACKS case:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{C++}</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;virtual void OnUnitIdle(const Unit* unit) final {</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    switch (unit-&gt;unit_type.ToType()) {</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        case UNIT_TYPEID::TERRAN_COMMANDCENTER: {</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;            Actions()-&gt;UnitCommand(unit, ABILITY_ID::TRAIN_SCV);</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;            break;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;        }</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;        case UNIT_TYPEID::TERRAN_SCV: {</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;            const Unit* mineral_target = FindNearestMineralPatch(unit-&gt;pos);</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;            if (!mineral_target) {</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;                break;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;            }</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;            Actions()-&gt;UnitCommand(unit, ABILITY_ID::SMART, mineral_target);</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;            break;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        }</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;        case UNIT_TYPEID::TERRAN_BARRACKS: {</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;            Actions()-&gt;UnitCommand(unit, ABILITY_ID::TRAIN_MARINE);</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;            break;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        }</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        case UNIT_TYPEID::TERRAN_MARINE: {</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;            const GameInfo&amp; game_info = Observation()-&gt;GetGameInfo();</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;            Actions()-&gt;UnitCommand(unit, ABILITY_ID::ATTACK_ATTACK, game_info.enemy_start_locations.front());</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;            break;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        }</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        default: {</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;            break;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        }</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    }</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;}</div></div><!-- fragment --><p>Notice how easy that is! In general, OnUnitIdle is an excellent function to add code to to control unit production and orders. At this point if you build and run the code your bot should build a barracks and start producing marines with them. Our last step should be to scout the enemy.</p>
<h2>Scouting Your Opponent </h2>
<p>In a normal match when the game begins the minimap is pinged with all possible starting locations of enemies, the api contains that same information in the ObservationInterface. You can retrieve it via GetGameInfo(). Lets use that function in our OnUnitIdle so a newly spawned marine will attack move towards the enemy as soon as it's spawned. It will be fun to see countless marines walk to their demise.</p>
<p>In your OnUnitIdle add the following code to your switch case -</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{C++}</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;case UNIT_TYPEID::TERRAN_MARINE: {</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    const GameInfo&amp; game_info = Observation()-&gt;GetGameInfo();</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    Actions()-&gt;UnitCommand(unit, ABILITY_ID::ATTACK_ATTACK, game_info.enemy_start_locations.front());</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    break;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;}</div></div><!-- fragment --><p>How fun, build and run and you can watch marines endlessly walk to their death.</p>
<h2>Exercises </h2>
<ol type="1">
<li>Try building and producing marines from three barracks instead of one.</li>
<li>(Challenging) Perform a simple rush, from your three barracks wait until you've gathered 10-20 marines then attack move to your enemy.</li>
</ol>
<h2>Full Source Code </h2>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{C++}</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;#include &lt;sc2api/sc2_api.h&gt;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;#include &lt;iostream&gt;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;using namespace sc2;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;class Bot : public Agent {</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;public:</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    virtual void OnGameStart() final {</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;        std::cout &lt;&lt; &quot;Hello, World!&quot; &lt;&lt; std::endl;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    }</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    virtual void OnStep() final {</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        TryBuildSupplyDepot();</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        TryBuildBarracks();</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    }</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    virtual void OnUnitIdle(const Unit* unit) final {</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        switch (unit-&gt;unit_type.ToType()) {</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;            case UNIT_TYPEID::TERRAN_COMMANDCENTER: {</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;                Actions()-&gt;UnitCommand(unit, ABILITY_ID::TRAIN_SCV);</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;                break;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;            }</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;            case UNIT_TYPEID::TERRAN_SCV: {</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;                const Unit* mineral_target = FindNearestMineralPatch(unit-&gt;pos);</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;                if (!mineral_target) {</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;                    break;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;                }</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;                Actions()-&gt;UnitCommand(unit, ABILITY_ID::SMART, mineral_target);</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                break;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;            }</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;            case UNIT_TYPEID::TERRAN_BARRACKS: {</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                Actions()-&gt;UnitCommand(unit, ABILITY_ID::TRAIN_MARINE);</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                break;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;            }</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;            case UNIT_TYPEID::TERRAN_MARINE: {</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                const GameInfo&amp; game_info = Observation()-&gt;GetGameInfo();</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                Actions()-&gt;UnitCommand(unit, ABILITY_ID::ATTACK_ATTACK, game_info.enemy_start_locations.front());</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                break;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;            }</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;            default: {</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                break;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            }</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        }</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    }</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;private:</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    size_t CountUnitType(UNIT_TYPEID unit_type) {</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        return Observation()-&gt;GetUnits(Unit::Alliance::Self, IsUnit(unit_type)).size();</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    }</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    bool TryBuildStructure(ABILITY_ID ability_type_for_structure, UNIT_TYPEID unit_type = UNIT_TYPEID::TERRAN_SCV) {</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        const ObservationInterface* observation = Observation();</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        // If a unit already is building a supply structure of this type, do nothing.</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        // Also get an scv to build the structure.</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        const Unit* unit_to_build = nullptr;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        Units units = observation-&gt;GetUnits(Unit::Alliance::Self);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        for (const auto&amp; unit : units) {</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            for (const auto&amp; order : unit-&gt;orders) {</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                if (order.ability_id == ability_type_for_structure) {</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                    return false;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                }</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            }</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            if (unit-&gt;unit_type == unit_type) {</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                unit_to_build = unit;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            }</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        }</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        float rx = GetRandomScalar();</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        float ry = GetRandomScalar();</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        Actions()-&gt;UnitCommand(unit_to_build,</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            ability_type_for_structure,</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            Point2D(unit_to_build-&gt;pos.x + rx * 15.0f, unit_to_build-&gt;pos.y + ry * 15.0f));</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        return true;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    }</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    bool TryBuildSupplyDepot() {</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        const ObservationInterface* observation = Observation();</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        // If we are not supply capped, don&#39;t build a supply depot.</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        if (observation-&gt;GetFoodUsed() &lt;= observation-&gt;GetFoodCap() - 2)</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            return false;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        // Try and build a depot. Find a random SCV and give it the order.</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        return TryBuildStructure(ABILITY_ID::BUILD_SUPPLYDEPOT);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    }</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    const Unit* FindNearestMineralPatch(const Point2D&amp; start) {</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        Units units = Observation()-&gt;GetUnits(Unit::Alliance::Neutral);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        float distance = std::numeric_limits&lt;float&gt;::max();</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        const Unit* target = nullptr;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        for (const auto&amp; u : units) {</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            if (u-&gt;unit_type == UNIT_TYPEID::NEUTRAL_MINERALFIELD) {</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                float d = DistanceSquared2D(u-&gt;pos, start);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                if (d &lt; distance) {</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                    distance = d;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                    target = u;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                }</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            }</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        }</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        return target;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    }</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    bool TryBuildBarracks() {</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        const ObservationInterface* observation = Observation();</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        if (CountUnitType(UNIT_TYPEID::TERRAN_SUPPLYDEPOT) &lt; 1) {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            return false;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        }</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        if (CountUnitType(UNIT_TYPEID::TERRAN_BARRACKS) &gt; 0) {</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            return false;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        }</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        return TryBuildStructure(ABILITY_ID::BUILD_BARRACKS);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    }</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;};</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;int main(int argc, char* argv[]) {</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    Coordinator coordinator;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    coordinator.LoadSettings(argc, argv);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    Bot bot;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    coordinator.SetParticipants({</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        CreateParticipant(Race::Terran, &amp;bot),</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        CreateComputer(Race::Zerg)</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    });</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    coordinator.LaunchStarcraft();</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    coordinator.StartGame(sc2::kMapBelShirVestigeLE);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    while (coordinator.Update()) {</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    }</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    return 0;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;}</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
